<div class="columns">
  <div class="column is-one-third">
    <div class="box">
      <div class="content">
        <%= render 'info', event: @event %>
      </div>
      <%= link_to 'Back', events_path %>
    </div>
  </div>

  <div class="column">
    <div class="box">
      <div class="container">
        <h1 class="title is-4">Attendees</h1>
        <% @event.attendees.each do |attendee| %>
          <div class="content">
            <div class="columns">
              <div class="column is-one-third">
                <p> - <%= attendee.name %> </p>
              </div>

              <% if user_signed_in? && current_user.id == @event.organizer_id%>  
              <div class="column">
                <%= link_to 'Delete', event_event_attending_path(@event, :user_id => attendee.id),
                 method: :delete, class: "button is-small" %>
              </div>
              <% end %>
            </div>
          </div>
        <% end %>

        <% if user_signed_in? && current_user.id != @event.organizer_id%>
          <%= form_with(model: @event, url: event_event_attendings_path(@event), method: "post") do |form| %>
            <%= hidden_field_tag(:user_id, current_user.id) %>
            <%= hidden_field_tag(:event_id, @event.id) %>
            <%= form.submit "Join", class: "button is-small"%>
          <% end %>
        <% end %>

      </div>
    </div>
  </div>

  <% if user_signed_in? && current_user.id == @event.organizer_id%>
  <div class="column">
    <div class="box">
      <div class="container">
        <h1 class="title is-4">Other Users</h1>
        <% @user.each do |user| %>
          <% if @event.organizer_id != user.id && !@event.attendees.exists?(:id => user.id)%>
            <div class="content">
              <div class="columns">
                <div class="column is-one-third">
                  <p> <%= user.name %> </p> 
                </div>
              
              <div class="column">
                <%= form_with(model: @event, url: event_event_attendings_path(@event), method: "post") do |form| %>
                  <%= hidden_field_tag(:user_id, user.id) %>
                  <%= hidden_field_tag(:event_id, @event.id) %>
                  <%= form.submit "invite", class: "button is-small"%>
                <% end %>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
  <% end %>

</div>


